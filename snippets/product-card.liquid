{% comment %}
  Product Card Snippet
  Displays a reusable product card component

  Usage:
  {% render 'product-card', product: product %}
{% endcomment %}

<div class="product-card">
  {% if product.compare_at_price > product.price %}
    <span class="product-badge-sale">Sale</span>
  {% endif %}

  <div class="product-image">
    {% if product.featured_image %}
      <img
        src="{{ product.featured_image | img_url: '400x400' }}"
        alt="{{ product.featured_image.alt | escape }}"
        width="400"
        height="400"
        loading="lazy">
    {% else %}
      <div class="placeholder-image">No image available</div>
    {% endif %}

    {% if product.images.size > 1 %}
      <span class="product-badge">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 6H5C3.89 6 3 6.9 3 8V16C3 17.1 3.89 18 5 18H19C20.1 18 21 17.1 21 16V8C21 6.9 20.1 6 19 6ZM19 8L12 13L5 8H19Z" fill="#333"/>
        </svg>
      </span>
    {% endif %}
  </div>

  {% if product.available %}
    <div class="color-options">
      {% assign color_count = 0 %}
      {% for variant in product.variants %}
        {% if color_count < 3 %}
          <span class="color-dot {% if color_count == 0 %}active{% endif %}" style="background: #f5f5f5;"></span>
          {% assign color_count = color_count | plus: 1 %}
        {% endif %}
      {% endfor %}
      {% if product.variants.size > 3 %}
        <span class="color-more">+{{ product.variants.size | minus: 3 }}</span>
      {% endif %}
    </div>
  {% endif %}

  <h3 class="product-title">{{ product.title }}</h3>

  {% if product.variants.size > 1 %}
    <p class="product-variant">
      {% if product.variants.first.option1 %}
        {{ product.variants.first.option1 }}
      {% else %}
        Variant
      {% endif %}
    </p>
  {% endif %}

  <div class="product-pricing">
    {% if product.compare_at_price > product.price %}
      <p class="product-price sale">
        <span class="sale-price">{{ product.price | money }}</span>
        <span class="original-price">{{ product.compare_at_price | money }}</span>
      </p>
    {% else %}
      <p class="product-price">{{ product.price | money }}</p>
    {% endif %}
  </div>

  {% if product.available %}
    <a href="{{ product.url }}" class="product-card-link">
      {{ "products.add_to_cart" | t }}
    </a>
  {% else %}
    <button class="product-card-button disabled" disabled>
      {{ "products.sold_out" | t }}
    </button>
  {% endif %}
</div>

<style>
  .product-card {
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .product-card:hover {
    transform: translateY(-5px);
  }

  .product-badge-sale {
    position: absolute;
    top: 10px;
    left: 10px;
    background: #369FFF;
    color: white;
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    z-index: 2;
  }

  .product-image {
    position: relative;
    aspect-ratio: 1;
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 10px;
    background: #f5f5f5;
  }

  .product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .placeholder-image {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #e0e0e0;
    color: #999;
    font-size: 14px;
  }

  .product-badge {
    position: absolute;
    bottom: 10px;
    right: 10px;
    width: 36px;
    height: 36px;
    background: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.3s;
  }

  .product-badge:hover {
    transform: scale(1.1);
  }

  .color-options {
    display: flex;
    gap: 6px;
    margin-bottom: 8px;
    align-items: center;
  }

  .color-dot {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 1px solid #e0e0e0;
    cursor: pointer;
    transition: all 0.3s;
  }

  .color-dot.active {
    border: 2px solid #1a1a1a;
  }

  .color-dot:hover {
    transform: scale(1.2);
  }

  .color-more {
    font-size: 12px;
    color: #666;
    margin-left: 4px;
  }

  .product-title {
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 4px;
    line-height: 1.3;
    color: #1a1a1a;
  }

  .product-variant {
    font-size: 12px;
    color: #666;
    margin-bottom: 8px;
  }

  .product-pricing {
    margin-bottom: 12px;
  }

  .product-price {
    font-size: 16px;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0;
  }

  .product-price.sale {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .sale-price {
    color: #ff4444;
  }

  .original-price {
    text-decoration: line-through;
    color: #999;
    font-weight: 400;
    font-size: 14px;
  }

  .product-card-link,
  .product-card-button {
    display: block;
    width: 100%;
    padding: 12px;
    text-align: center;
    text-decoration: none;
    background: #1a1a1a;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
  }

  .product-card-link:hover {
    background: #369FFF;
  }

  .product-card-button.disabled {
    background: #e0e0e0;
    color: #999;
    cursor: not-allowed;
  }
</style>
